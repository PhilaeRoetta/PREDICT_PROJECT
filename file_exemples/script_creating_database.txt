CREATE OR REPLACE DATABASE #DATABASE#;

CREATE OR REPLACE SCHEMA #DATABASE#.LANDING;

CREATE OR REPLACE TABLE #DATABASE#.LANDING.LANDING_OUTPUT_NEED(
	TASK_RUN VARCHAR(32) NOT NULL,
	SEASON_ID VARCHAR(10) NOT NULL,
	SEASON_SPORT VARCHAR(50),
	SEASON_COUNTRY VARCHAR(50),
	SEASON_NAME VARCHAR(50),
	SEASON_DIVISION VARCHAR(50),
	COMPETITION_ID VARCHAR(10),
	GAMEDAY VARCHAR(50) NOT NULL,
	TS_TASK_UTC TIMESTAMP,
	TS_TASK_LOCAL TIMESTAMP,
	IS_TO_INIT NUMBER(1) NOT NULL,
	IS_TO_CALCULATE NUMBER(1) NOT NULL,
	IS_TO_DELETE NUMBER(1) NOT NULL,
	IS_TO_RECALCULATE NUMBER(1) NOT NULL,
	MESSAGE_ACTION VARCHAR(32) NOT NULL,
	GAME_ACTION VARCHAR(32) NOT NULL,
	LASTCHECK_MESSAGE_TS_UTC TIMESTAMP NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.LANDING.LANDING_SEASON(
	SEASON_ID VARCHAR(10) NOT NULL,
	SEASON_SPORT VARCHAR(50) NOT NULL,
	SEASON_COUNTRY VARCHAR(50) NOT NULL,
	SEASON_NAME VARCHAR(50) NOT NULL,
	SEASON_DIVISION VARCHAR(50) NOT NULL,
	SEASON_TEAMCHOICE_DEADLINE DATE NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.LANDING.LANDING_COMPETITION (
	SEASON_ID VARCHAR(10) NOT NULL,
	COMPETITION_ID VARCHAR(10) NOT NULL,
	COMPETITION_LABEL VARCHAR(200) NOT NULL,
	COMPETITION_SOURCE VARCHAR(10) NOT NULL,
	COMPETITION_SOURCE_ID INT NOT NULL,
	IS_SAME_FOR_PREDICTCHAMP NUMBER(1) NOT NULL,
	IS_TO_LOAD NUMBER(1) NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.LANDING.LANDING_GAME (
	COMPETITION_SOURCE VARCHAR(10) NOT NULL,
	COMPETITION_ID VARCHAR(10) NOT NULL,
	SEASON_ID VARCHAR(10) NOT NULL,
	GAMEDAY VARCHAR(50) NOT NULL,
	DATE_GAME_UTC DATE NOT NULL,
	TIME_GAME_UTC TIME,
	DATE_GAME_LOCAL DATE NOT NULL,
	TIME_GAME_LOCAL TIME,
	TEAM_HOME VARCHAR(200) NOT NULL,
	SCORE_HOME INT NOT NULL,
	TEAM_AWAY VARCHAR(200) NOT NULL,
	SCORE_AWAY INT NOT NULL,
	GAME_SOURCE_ID VARCHAR(100) NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.LANDING.LANDING_PREDICTCHAMP_GAME_TO_ADD (
	PREDICTCHAMP_GAME_ID INT NOT NULL,
	SEASON_ID VARCHAR(10) NOT NULL,
	GAMEDAY VARCHAR(50) NOT NULL,
	TEAM_HOME VARCHAR(200) NOT NULL,
	TEAM_AWAY VARCHAR(200) NOT NULL,
	HAS_HOME_ADV NUMBER(1) NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.LANDING.LANDING_GAME_MODIFICATION(
	SEASON_ID VARCHAR(10) NOT NULL,
	GAME_SOURCE_ID VARCHAR(100) NOT NULL,
	GAME_FORUM_ID INT NOT NULL
);
	
CREATE OR REPLACE TABLE #DATABASE#.LANDING.LANDING_GAMEDAY_MODIFICATION(
	SEASON_ID VARCHAR(10) NOT NULL,
	COMPETITION_ID VARCHAR(10) NOT NULL,
	GAMEDAY VARCHAR(50) NOT NULL,
	GAMEDAY_MODIFIED VARCHAR(50) NOT NULL
);	

CREATE OR REPLACE TABLE #DATABASE#.LANDING.LANDING_MESSAGE_CHECK (
	FORUM_SOURCE VARCHAR(10) NOT NULL,
	TOPIC_NUMBER INT NOT NULL,
	USER VARCHAR(200) NOT NULL,
	MESSAGE_FORUM_ID INT NOT NULL,
	CREATION_TIME_LOCAL TIMESTAMP NOT NULL,
	EDITION_TIME_LOCAL TIMESTAMP,
	MESSAGE_CONTENT STRING
);

CREATE OR REPLACE TABLE #DATABASE#.LANDING.LANDING_MESSAGE (
	FORUM_SOURCE VARCHAR(10) NOT NULL,
	TOPIC_NUMBER INT NOT NULL,
	USER VARCHAR(200) NOT NULL,
	MESSAGE_FORUM_ID INT NOT NULL,
	CREATION_TIME TIMESTAMP NOT NULL,
	EDITION_TIME TIMESTAMP,
	MESSAGE_CONTENT STRING,
	TIME_RECEPTION TIMESTAMP NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.LANDING.LANDING_TOPIC(
	SEASON_ID VARCHAR(10) NOT NULL,
	FORUM_SOURCE VARCHAR(10) NOT NULL,
	FORUM_COUNTRY VARCHAR(50) NOT NULL,
	TOPIC_NUMBER INT NOT NULL,
	IS_FOR_PREDICT NUMBER(1) NOT NULL,
	IS_FOR_RESULT NUMBER(1) NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.LANDING.LANDING_CORRECTION_PREDICTION(
	FORUM_SOURCE VARCHAR(10) NOT NULL,
	MESSAGE_FORUM_ID INT NOT NULL,
	PREDICT_ID VARCHAR(32) NOT NULL,
	PREDICT VARCHAR(32) NOT NULL,
	IS_PROGRAM_REFINEMENT NUMBER(1) NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.LANDING.LANDING_MESSAGE_QUOTE_TO_KEEP(
	FORUM_SOURCE VARCHAR(10) NOT NULL,
	MESSAGE_FORUM_ID INT NOT NULL
);




CREATE OR REPLACE SCHEMA #DATABASE#.CURATED;

CREATE OR REPLACE TABLE #DATABASE#.CURATED.CURATED_SEASON(
	SEASON_KEY VARCHAR(32) NOT NULL,
	SEASON_ID VARCHAR(10) NOT NULL,
	SEASON_SPORT VARCHAR(50) NOT NULL,
	SEASON_COUNTRY VARCHAR(50) NOT NULL,
	SEASON_NAME VARCHAR(50) NOT NULL,
	SEASON_DIVISION VARCHAR(50) NOT NULL,
	SEASON_TEAMCHOICE_DEADLINE DATE NOT NULL,
	UPDATED_AT_UTC TIMESTAMP NOT NULL,
	UPDATED_AT_LOCAL TIMESTAMP NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.CURATED.CURATED_COMPETITION(
	COMPETITION_KEY VARCHAR(32) NOT NULL,
	SEASON_KEY VARCHAR(32) NOT NULL,
	COMPETITION_ID VARCHAR(10) NOT NULL,
	COMPETITION_SOURCE VARCHAR(50) NOT NULL,
	COMPETITION_LABEL VARCHAR(50) NOT NULL,
	IS_SAME_FOR_PREDICTCHAMP NUMBER(1) NOT NULL,
	UPDATED_AT_UTC TIMESTAMP NOT NULL,
	UPDATED_AT_LOCAL TIMESTAMP NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.CURATED.CURATED_TEAM(
	TEAM_KEY VARCHAR(32) NOT NULL,
	SEASON_KEY VARCHAR(32) NOT NULL,
	TEAM_NAME VARCHAR(50) NOT NULL,
	UPDATED_AT_UTC TIMESTAMP NOT NULL,
	UPDATED_AT_LOCAL TIMESTAMP NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.CURATED.CURATED_GAMEDAY(
	GAMEDAY_KEY VARCHAR(32) NOT NULL,
	SEASON_KEY VARCHAR(32) NOT NULL,
	COMPETITION_KEY VARCHAR(32) NOT NULL,
	GAMEDAY VARCHAR(50) NOT NULL,
	GAMEDAY_MESSAGE VARCHAR(50) NOT NULL,
	IS_PLAYED NUMBER(1) NOT NULL,
	IS_PARTIALLY_PLAYED NUMBER(1) NOT NULL,
	BEGIN_DATE_LOCAL DATE,
	BEGIN_TIME_LOCAL TIME,
	END_DATE_LOCAL DATE,
	END_TIME_LOCAL TIME,
	BEGIN_DATE_UTC DATE,
	BEGIN_TIME_UTC TIME,
	END_DATE_UTC DATE,
	END_TIME_UTC TIME,
	IS_TO_INIT NUMBER(1) NOT NULL,
	IS_TO_CALCULATE NUMBER(1) NOT NULL,
	IS_TO_DELETE NUMBER(1) NOT NULL,
	IS_TO_RECALCULATE NUMBER(1) NOT NULL,
	UPDATED_AT_UTC TIMESTAMP NOT NULL,
	UPDATED_AT_LOCAL TIMESTAMP NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.CURATED.CURATED_GAME(
	GAME_KEY VARCHAR(32) NOT NULL,
	SEASON_KEY VARCHAR(32) NOT NULL,
	COMPETITION_KEY VARCHAR(32) NOT NULL,
	GAMEDAY_KEY VARCHAR(32) NOT NULL,
	TEAM_HOME_KEY VARCHAR(32) NOT NULL,
	TEAM_AWAY_KEY VARCHAR(32) NOT NULL,
	GAME_SOURCE_ID VARCHAR(100) NOT NULL,
	GAME_MESSAGE_SHORT INT NOT NULL,
	GAME_MESSAGE VARCHAR(50) NOT NULL,
	DATE_GAME_LOCAL DATE,
	TIME_GAME_LOCAL TIME,
	DATE_GAME_UTC DATE,
	TIME_GAME_UTC TIME,
	SCORE_HOME INT NOT NULL,
	SCORE_AWAY INT NOT NULL,
	RESULT INT NOT NULL,
	IS_PLAYED NUMBER(1) NOT NULL,
	UPDATED_AT_UTC TIMESTAMP NOT NULL,
	UPDATED_AT_LOCAL TIMESTAMP NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.CURATED.CURATED_GAME_PREDICTCHAMP(
	GAME_KEY VARCHAR(32) NOT NULL,
	SEASON_KEY VARCHAR(32) NOT NULL,
	COMPETITION_KEY VARCHAR(32) NOT NULL,
	GAMEDAY_KEY VARCHAR(32) NOT NULL,
	GAME_MESSAGE_SHORT INT NOT NULL,
	GAME_MESSAGE VARCHAR(50) NOT NULL,
	GAME_SOURCE_ID VARCHAR(100),
	GAME_PC_ID INT,
	TEAM_HOME_KEY VARCHAR(32) NOT NULL,
	TEAM_AWAY_KEY VARCHAR(32) NOT NULL,
	HAS_HOME_ADV NUMBER(1) NOT NULL,
	IS_FOR_RANK NUMBER(1) NOT NULL,
	UPDATED_AT_UTC TIMESTAMP NOT NULL,
	UPDATED_AT_LOCAL TIMESTAMP NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.CURATED.CURATED_FORUM(
	FORUM_KEY VARCHAR(32) NOT NULL,
	FORUM_SOURCE VARCHAR(50) NOT NULL,
	FORUM_COUNTRY VARCHAR(50) NOT NULL,
	UPDATED_AT_UTC TIMESTAMP NOT NULL,
	UPDATED_AT_LOCAL TIMESTAMP NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.CURATED.CURATED_TOPIC(
	TOPIC_KEY VARCHAR(32) NOT NULL,
	FORUM_KEY VARCHAR(32) NOT NULL,	
	SEASON_KEY VARCHAR(32) NOT NULL,	
	FORUM_SOURCE VARCHAR(50) NOT NULL,
	TOPIC_NUMBER VARCHAR(50) NOT NULL,
	IS_FOR_PREDICT NUMBER(1) NOT NULL,
	IS_FOR_RESULT NUMBER(1) NOT NULL,
	UPDATED_AT_UTC TIMESTAMP NOT NULL,
	UPDATED_AT_LOCAL TIMESTAMP NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.CURATED.CURATED_USER(
	USER_KEY VARCHAR(32) NOT NULL,
	USER_NAME VARCHAR(50) NOT NULL,
	SEASON_KEY VARCHAR(32) NOT NULL,
	UPDATED_AT_UTC TIMESTAMP NOT NULL,
	UPDATED_AT_LOCAL TIMESTAMP NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.CURATED.CURATED_MESSAGE_CHECK(
	MESSAGE_KEY VARCHAR(32) NOT NULL,
	MESSAGE_EDITION_KEY VARCHAR(32) NOT NULL,
	FORUM_KEY VARCHAR(32) NOT NULL,
	TOPIC_KEY VARCHAR(32) NOT NULL,
	SEASON_KEY VARCHAR(32) NOT NULL,
	USER_KEY VARCHAR(32) NOT NULL,
	MESSAGE_FORUM_ID INT NOT NULL,
	CREATION_TIME_LOCAL TIMESTAMP NOT NULL,
	EDITION_TIME_LOCAL TIMESTAMP NOT NULL,
	CREATION_TIME_UTC TIMESTAMP NOT NULL,
	EDITION_TIME_UTC TIMESTAMP NOT NULL,
	MESSAGE_CONTENT STRING,
	IS_PROGRAM_INIT_MESSAGE NUMBER(1) NOT NULL,
	IS_PROGRAM_CALCUL_MESSAGE NUMBER(1) NOT NULL,
	IS_MESSAGE_TO_AVOID NUMBER(1) NOT NULL,
	IS_MESSAGE_TO_PROCESS NUMBER(1) NOT NULL,
	DBT_SCD_ID VARCHAR(32) NOT NULL,
	DBT_UPDATED_AT TIMESTAMP NOT NULL,
	DBT_VALID_FROM TIMESTAMP NOT NULL,
	DBT_VALID_TO TIMESTAMP
);

CREATE OR REPLACE TABLE #DATABASE#.CURATED.CURATED_MESSAGE(
	MESSAGE_KEY VARCHAR(32) NOT NULL,
	MESSAGE_EDITION_KEY VARCHAR(32) NOT NULL,
	FORUM_KEY VARCHAR(32) NOT NULL,
	TOPIC_KEY VARCHAR(32) NOT NULL,
	SEASON_KEY VARCHAR(32) NOT NULL,
	USER_KEY VARCHAR(32) NOT NULL,
	MESSAGE_FORUM_ID INT NOT NULL,
	CREATION_TIME_LOCAL TIMESTAMP NOT NULL,
	EDITION_TIME_LOCAL TIMESTAMP NOT NULL,
	CREATION_TIME_UTC TIMESTAMP NOT NULL,
	EDITION_TIME_UTC TIMESTAMP NOT NULL,
	MESSAGE_CONTENT STRING,
	IS_PROGRAM_INIT_MESSAGE NUMBER(1) NOT NULL,
	IS_PROGRAM_CALCUL_MESSAGE NUMBER(1) NOT NULL,
	IS_MESSAGE_TO_AVOID NUMBER(1) NOT NULL,
	IS_MESSAGE_TO_PROCESS NUMBER(1) NOT NULL,
	DBT_SCD_ID VARCHAR(32) NOT NULL,
	DBT_UPDATED_AT TIMESTAMP NOT NULL,
	DBT_VALID_FROM TIMESTAMP NOT NULL,
	DBT_VALID_TO TIMESTAMP
);

CREATE OR REPLACE TABLE #DATABASE#.CURATED.CURATED_PREDICTRAW_CHECK(
	PREDICT_KEY VARCHAR(32) NOT NULL,
	MESSAGE_EDITION_KEY VARCHAR(32) NOT NULL,
	SEASON_KEY VARCHAR(32) NOT NULL,
	USER_KEY VARCHAR(32) NOT NULL,
	FORUM_KEY VARCHAR(32) NOT NULL,
	EDITION_TIME_LOCAL TIMESTAMP NOT NULL,
	EDITION_TIME_UTC TIMESTAMP NOT NULL,
	MESSAGE_TRANSFORMED STRING,
	ARRAY_PREDICTIONS VARIANT,
	PREDICTION STRING,
	PREDICT_ID STRING NOT NULL,
	PREDICT_RAW STRING NOT NULL,
	IS_PREDICTION_FROM_MESSAGE NUMBER(1) NOT NULL,
	IS_PROGRAM_REFINEMENT NUMBER(1) NOT NULL,
	UPDATED_AT_UTC TIMESTAMP NOT NULL,
	UPDATED_AT_LOCAL TIMESTAMP NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.CURATED.CURATED_PREDICT_GAME_CHECK(
	PREDICT_GAME_KEY VARCHAR(32) NOT NULL,
	MESSAGE_EDITION_KEY VARCHAR(32) NOT NULL,
	SEASON_KEY VARCHAR(32) NOT NULL,
	USER_KEY VARCHAR(32) NOT NULL,
	FORUM_KEY VARCHAR(32) NOT NULL,
	EDITION_TIME_LOCAL TIMESTAMP NOT NULL,
	EDITION_TIME_UTC TIMESTAMP NOT NULL,
	GAME_KEY VARCHAR(32) NOT NULL,
	PREDICT_ID STRING NOT NULL,
	PREDICT_RAW STRING NOT NULL,
	PREDICT INT NOT NULL,
	IS_PREDICTION_FROM_MESSAGE NUMBER(1) NOT NULL,
	IS_PROGRAM_REFINEMENT NUMBER(1) NOT NULL,
	IS_LAST_ONTIME NUMBER(1) NOT NULL,
	UPDATED_AT_UTC TIMESTAMP NOT NULL,
	UPDATED_AT_LOCAL TIMESTAMP NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.CURATED.CURATED_PREDICT_GAME(
	PREDICT_GAME_KEY VARCHAR(32) NOT NULL,
	MESSAGE_EDITION_KEY VARCHAR(32) NOT NULL,
	SEASON_KEY VARCHAR(32) NOT NULL,
	USER_KEY VARCHAR(32) NOT NULL,
	FORUM_KEY VARCHAR(32) NOT NULL,
	EDITION_TIME_LOCAL TIMESTAMP NOT NULL,
	EDITION_TIME_UTC TIMESTAMP NOT NULL,
	GAME_KEY VARCHAR(32) NOT NULL,
	PREDICT_ID STRING NOT NULL,
	PREDICT_RAW STRING NOT NULL,
	PREDICT INT NOT NULL,
	IS_PREDICTION_FROM_MESSAGE NUMBER(1) NOT NULL,
	IS_PROGRAM_REFINEMENT NUMBER(1) NOT NULL,
	IS_LAST_ONTIME NUMBER(1) NOT NULL,
	UPDATED_AT_UTC TIMESTAMP NOT NULL,
	UPDATED_AT_LOCAL TIMESTAMP NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.CURATED.CURATED_CHOICE_BONUS_CHECK(
	CHOICE_BONUS_KEY VARCHAR(32) NOT NULL,
	MESSAGE_EDITION_KEY VARCHAR(32) NOT NULL,
	SEASON_KEY VARCHAR(32) NOT NULL,
	USER_KEY VARCHAR(32) NOT NULL,
	FORUM_KEY VARCHAR(32) NOT NULL,
	GAMEDAY_KEY VARCHAR(32) NOT NULL,
	GAME_KEY VARCHAR(32) NOT NULL,
	EDITION_TIME_LOCAL TIMESTAMP NOT NULL,
	EDITION_TIME_UTC TIMESTAMP NOT NULL,
	PREDICT_ID STRING NOT NULL,
	PREDICT_RAW STRING NOT NULL,
	PREDICT VARCHAR(50) NOT NULL,
	IS_PREDICTION_FROM_MESSAGE NUMBER(1) NOT NULL,
	IS_PROGRAM_REFINEMENT NUMBER(1) NOT NULL,
	IS_LAST_ONTIME NUMBER(1) NOT NULL,
	UPDATED_AT_UTC TIMESTAMP NOT NULL,
	UPDATED_AT_LOCAL TIMESTAMP NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.CURATED.CURATED_CHOICE_BONUS(
	CHOICE_BONUS_KEY VARCHAR(32) NOT NULL,
	MESSAGE_EDITION_KEY VARCHAR(32) NOT NULL,
	SEASON_KEY VARCHAR(32) NOT NULL,
	USER_KEY VARCHAR(32) NOT NULL,
	FORUM_KEY VARCHAR(32) NOT NULL,
	GAMEDAY_KEY VARCHAR(32) NOT NULL,
	GAME_KEY VARCHAR(32) NOT NULL,
	EDITION_TIME_LOCAL TIMESTAMP NOT NULL,
	EDITION_TIME_UTC TIMESTAMP NOT NULL,
	PREDICT_ID STRING NOT NULL,
	PREDICT_RAW STRING NOT NULL,
	PREDICT VARCHAR(50) NOT NULL,
	IS_PREDICTION_FROM_MESSAGE NUMBER(1) NOT NULL,
	IS_PROGRAM_REFINEMENT NUMBER(1) NOT NULL,
	IS_LAST_ONTIME NUMBER(1) NOT NULL,
	UPDATED_AT_UTC TIMESTAMP NOT NULL,
	UPDATED_AT_LOCAL TIMESTAMP NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.CURATED.CURATED_CHOICE_TEAM_CHECK(
	CHOICE_TEAM_KEY VARCHAR(32) NOT NULL,
	MESSAGE_EDITION_KEY VARCHAR(32) NOT NULL,
	SEASON_KEY VARCHAR(32) NOT NULL,
	USER_KEY VARCHAR(32) NOT NULL,
	FORUM_KEY VARCHAR(32) NOT NULL,
	TEAM_KEY VARCHAR(32) NOT NULL,
	EDITION_TIME_LOCAL TIMESTAMP NOT NULL,
	EDITION_TIME_UTC TIMESTAMP NOT NULL,
	PREDICT_ID STRING NOT NULL,
	PREDICT_RAW STRING NOT NULL,
	PREDICT VARCHAR(50) NOT NULL,
	IS_PREDICTION_FROM_MESSAGE NUMBER(1) NOT NULL,
	IS_PROGRAM_REFINEMENT NUMBER(1) NOT NULL,
	IS_ONTIME NUMBER(1) NOT NULL,
	UPDATED_AT_UTC TIMESTAMP NOT NULL,
	UPDATED_AT_LOCAL TIMESTAMP NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.CURATED.CURATED_CHOICE_TEAM(
	CHOICE_TEAM_KEY VARCHAR(32) NOT NULL,
	MESSAGE_EDITION_KEY VARCHAR(32) NOT NULL,
	SEASON_KEY VARCHAR(32) NOT NULL,
	USER_KEY VARCHAR(32) NOT NULL,
	FORUM_KEY VARCHAR(32) NOT NULL,
	TEAM_KEY VARCHAR(32) NOT NULL,
	EDITION_TIME_LOCAL TIMESTAMP NOT NULL,
	EDITION_TIME_UTC TIMESTAMP NOT NULL,
	PREDICT_ID STRING NOT NULL,
	PREDICT_RAW STRING NOT NULL,
	PREDICT VARCHAR(50) NOT NULL,
	IS_PREDICTION_FROM_MESSAGE NUMBER(1) NOT NULL,
	IS_PROGRAM_REFINEMENT NUMBER(1) NOT NULL,
	IS_ONTIME NUMBER(1) NOT NULL,
	UPDATED_AT_UTC TIMESTAMP NOT NULL,
	UPDATED_AT_LOCAL TIMESTAMP NOT NULL
);

CREATE OR REPLACE SCHEMA #DATABASE#.CONSUMPTED;

CREATE OR REPLACE TABLE #DATABASE#.CONSUMPTED.CONSUMPTED_SEASON(
	SEASON_KEY VARCHAR(32) NOT NULL,
	SEASON_ID VARCHAR(10) NOT NULL,
	SEASON_SPORT VARCHAR(50) NOT NULL,
	SEASON_COUNTRY VARCHAR(50) NOT NULL,
	SEASON_NAME VARCHAR(50) NOT NULL,
	SEASON_DIVISION VARCHAR(50) NOT NULL,
	SEASON_TEAMCHOICE_DEADLINE DATE NOT NULL,
	UPDATED_AT_UTC TIMESTAMP NOT NULL,
	UPDATED_AT_LOCAL TIMESTAMP NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.CONSUMPTED.CONSUMPTED_COMPETITION(
	COMPETITION_KEY VARCHAR(32) NOT NULL,
	SEASON_KEY VARCHAR(32) NOT NULL,
	COMPETITION_ID VARCHAR(10) NOT NULL,
	COMPETITION_SOURCE VARCHAR(50) NOT NULL,
	COMPETITION_LABEL VARCHAR(50) NOT NULL,
	IS_SAME_FOR_PREDICTCHAMP NUMBER(1) NOT NULL,
	UPDATED_AT_UTC TIMESTAMP NOT NULL,
	UPDATED_AT_LOCAL TIMESTAMP NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.CONSUMPTED.CONSUMPTED_GAMEDAY(
	GAMEDAY_KEY VARCHAR(32) NOT NULL,
	SEASON_KEY VARCHAR(32) NOT NULL,
	COMPETITION_KEY VARCHAR(32) NOT NULL,
	GAMEDAY VARCHAR(50) NOT NULL,
	GAMEDAY_MESSAGE VARCHAR(50) NOT NULL,
	NB_GAME INT NOT NULL,
	IS_PLAYED NUMBER(1) NOT NULL,
	IS_PARTIALLY_PLAYED NUMBER(1) NOT NULL,
	BEGIN_DATE_LOCAL DATE,
	BEGIN_TIME_LOCAL TIME,
	END_DATE_LOCAL DATE,
	END_TIME_LOCAL TIME,
	BEGIN_DATE_UTC DATE,
	BEGIN_TIME_UTC TIME,
	END_DATE_UTC DATE,
	END_TIME_UTC TIME,
	IS_TO_CALCULATE NUMBER(1) NOT NULL,
	IS_TO_DELETE NUMBER(1) NOT NULL,
	IS_CALCULATED NUMBER(1) NOT NULL,
	IS_OUTPUT_INIT NUMBER(1) NOT NULL,
	IS_OUTPUT_CALCULATION NUMBER(1) NOT NULL,
	UPDATED_AT_UTC TIMESTAMP NOT NULL,
	UPDATED_AT_LOCAL TIMESTAMP NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.CONSUMPTED.CONSUMPTED_GAME(
	GAME_KEY VARCHAR(32) NOT NULL,
	SEASON_KEY VARCHAR(32) NOT NULL,
	COMPETITION_KEY VARCHAR(32) NOT NULL,
	GAMEDAY_KEY VARCHAR(32) NOT NULL,
	GAME_SOURCE_ID VARCHAR(100) NOT NULL,
	GAME_MESSAGE_SHORT INT NOT NULL,
	GAME_MESSAGE VARCHAR(50) NOT NULL,
	DATE_GAME_LOCAL DATE,
	TIME_GAME_LOCAL TIME,
	DATE_GAME_UTC DATE,
	TIME_GAME_UTC TIME,
	TEAM_HOME_KEY VARCHAR(32) NOT NULL,
	TEAM_AWAY_KEY VARCHAR(32) NOT NULL,
	SCORE_HOME INT NOT NULL,
	SCORE_AWAY INT NOT NULL,
	RESULT INT NOT NULL,
	IS_PLAYED NUMBER(1) NOT NULL,
	UPDATED_AT_UTC TIMESTAMP NOT NULL,
	UPDATED_AT_LOCAL TIMESTAMP NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.CONSUMPTED.CONSUMPTED_FORUM(
	FORUM_KEY VARCHAR(32) NOT NULL,
	FORUM_SOURCE VARCHAR(50) NOT NULL,
	FORUM_COUNTRY VARCHAR(50) NOT NULL,
	UPDATED_AT_UTC TIMESTAMP NOT NULL,
	UPDATED_AT_LOCAL TIMESTAMP NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.CONSUMPTED.CONSUMPTED_TOPIC(
	TOPIC_KEY VARCHAR(32) NOT NULL,
	FORUM_KEY VARCHAR(32) NOT NULL,	
	SEASON_KEY VARCHAR(32) NOT NULL,	
	FORUM_SOURCE VARCHAR(50) NOT NULL,
	TOPIC_NUMBER VARCHAR(50) NOT NULL,
	IS_FOR_PREDICT NUMBER(1) NOT NULL,
	IS_FOR_RESULT NUMBER(1) NOT NULL,
	UPDATED_AT_UTC TIMESTAMP NOT NULL,
	UPDATED_AT_LOCAL TIMESTAMP NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.CONSUMPTED.CONSUMPTED_TEAM(
	TEAM_KEY VARCHAR(32) NOT NULL,
	SEASON_KEY VARCHAR(32) NOT NULL,	
	TEAM_NAME VARCHAR(50) NOT NULL,
	WIN INT NOT NULL,
	LOSS INT NOT NULL,
	PERC_WIN DECIMAL(5,2) NOT NULL,
	POINTS_PRO INT NOT NULL,
	POINTS_AGAINST INT NOT NULL,
	POINTS_DIFF INT NOT NULL,
	UPDATED_AT_UTC TIMESTAMP NOT NULL,
	UPDATED_AT_LOCAL TIMESTAMP NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.CONSUMPTED.CONSUMPTED_PREDICT_GAME(
	PREDICT_GAME_KEY VARCHAR(32) NOT NULL,
	SEASON_KEY VARCHAR(32) NOT NULL,
	USER_KEY VARCHAR(32) NOT NULL,
	GAMEDAY_KEY VARCHAR(32) NOT NULL,
	GAME_KEY VARCHAR(32) NOT NULL,
	GAME_RESULT INT NOT NULL,
	PREDICT_ID STRING NOT NULL,
	PREDICT INT NOT NULL,
	IS_BONUS_GAME NUMBER(1) NOT NULL,
	IS_PREDICTION_IN_DEFECT NUMBER(1) NOT NULL,
	SCORE_WIN INT NOT NULL,
	SCORE_SHIFT INT NOT NULL,
	AUTOMATIC_SCORE INT NOT NULL,
	SCORE INT NOT NULL,
	NB_PREDICTION INT NOT NULL,
	UPDATED_AT_UTC TIMESTAMP NOT NULL,
	UPDATED_AT_LOCAL TIMESTAMP NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.CONSUMPTED.CONSUMPTED_USER_GAMEDAY(
	USER_GAMEDAY_KEY VARCHAR(32) NOT NULL,
	USER_KEY VARCHAR(32) NOT NULL,
	GAMEDAY_KEY VARCHAR(32) NOT NULL,
	SEASON_KEY VARCHAR(32) NOT NULL,
	NB_GAME INT NOT NULL,
	ARE_PREDICTIONS_IN_DEFECT NUMBER(1) NOT NULL,
	CALCULATED_SCORE INT NOT NULL,
	AUTOMATIC_SCORE INT NOT NULL,
	PARTICIPATION_SCORE INT NOT NULL,
	TOTAL_SCORE INT NOT NULL,
	POINTS INT NOT NULL,
	NB_PREDICTION INT NOT NULL,
	TEAM_CHOICE_KEY VARCHAR(32),
	UPDATED_AT_UTC TIMESTAMP NOT NULL,
	UPDATED_AT_LOCAL TIMESTAMP NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.CONSUMPTED.CONSUMPTED_USER(
	USER_KEY VARCHAR(32) NOT NULL,
	USER_NAME VARCHAR(50) NOT NULL,
	SEASON_KEY VARCHAR(32) NOT NULL,
	TOTAL_POINTS INT NOT NULL,
	NB_PREDICTION INT NOT NULL,
	NB_GAMEDAY_PREDICT INT NOT NULL,
	NB_GAMEDAY_FIRST INT NOT NULL,
	UPDATED_AT_UTC TIMESTAMP NOT NULL,
	UPDATED_AT_LOCAL TIMESTAMP NOT NULL
);

CREATE OR REPLACE TABLE #DATABASE#.CONSUMPTED.CONSUMPTED_GAME_PREDICTCHAMP(
	SEASON_KEY VARCHAR(32) NOT NULL,
	COMPETITION_KEY VARCHAR(32) NOT NULL,
	GAMEDAY_KEY VARCHAR(32) NOT NULL,
	GAME_KEY VARCHAR(32) NOT NULL,
	GAME_MESSAGE_SHORT INT NOT NULL,
	GAME_MESSAGE VARCHAR(50) NOT NULL,
	GAME_SOURCE_ID VARCHAR(100),
	GAME_PC_ID INT,
	TEAM_HOME_KEY VARCHAR(32) NOT NULL,
	TEAM_AWAY_KEY VARCHAR(32) NOT NULL,
	HAS_HOME_ADV NUMBER(1) NOT NULL,
	IS_FOR_RANK NUMBER(1) NOT NULL,
	POINTS_BASE INT NOT NULL,
	POINTS_BONUS INT NOT NULL,
	POINTS_HOME INT NOT NULL,
	POINTS_AWAY INT NOT NULL,
	WINNER NUMBER(1) NOT NULL,
	UPDATED_AT_UTC TIMESTAMP NOT NULL,
	UPDATED_AT_LOCAL TIMESTAMP NOT NULL
);