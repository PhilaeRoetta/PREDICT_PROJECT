unit_tests:
  - name: test_curated_user
    model: curated_user
    given:
      - input: source('LAND','MESSAGE_CHECK')
        format: csv
        rows: |
          FORUM_SOURCE,TOPIC_NUMBER,USER,MESSAGE_FORUM_ID,CREATION_TIME_LOCAL,EDITION_TIME_LOCAL,MESSAGE_CONTENT
          BI,108506,user1,1,2024-01-02 03:04:05,,blabla1
          BI,108506,user2,2,2024-06-07 08:09:10,2024-11-12 00:13:14,blabla2

      - input: ref('curated_topic')
        format: csv
        rows: |
          TOPIC_KEY,FORUM_KEY,SEASON_KEY,FORUM_SOURCE,TOPIC_NUMBER,IS_FOR_PREDICT,IS_FOR_RESULT
          44ee900ed19db8d1f9a75dbd7b187ca4,b4d2197189f192c4e623999bc6167df1,ab79b12cfeaf0cc39dc7676a91fa737a,BI,108506,1,0
          79a1de01beddb1503307b5c7e62e661c,b4d2197189f192c4e623999bc6167df1,ab79b12cfeaf0cc39dc7676a91fa737a,BI,108504,0,1

      - input: ref('curated_season')
        format: csv
        rows: |
          SEASON_KEY,SEASON_ID,SEASON_SPORT,SEASON_COUNTRY,SEASON_NAME,SEASON_DIVISION,SEASON_TEAMCHOICE_DEADLINE
          ab79b12cfeaf0cc39dc7676a91fa737a,S1,BASKETBALL,FRANCE,2024-2025,PROB,2025-05-09

      - input: ref('local_time')
        format: csv
        rows: |
          COUNTRY,TIMEZONE
          FRANCE,Europe/Paris

    expect:
      format: csv
      rows: |
        USER_KEY,USER_NAME,SEASON_KEY
        5ce84b3ad151935f085d6ba5ab876466,user1,ab79b12cfeaf0cc39dc7676a91fa737a
        b483a4ac17ceeab782129cfc915a9d37,user2,ab79b12cfeaf0cc39dc7676a91fa737a