unit_tests:
  - name: test_curated_forum
    model: curated_forum
    given:
      - input: source('LAND','TOPIC')
        format: csv
        rows: |
          SEASON_ID,FORUM_SOURCE,FORUM_COUNTRY,TOPIC_NUMBER,IS_FOR_PREDICT,IS_FOR_RESULT
          S1,BI,FRANCE,108506,1,0
          S1,BI,FRANCE,108504,0,1

      - input: ref('local_time')
        format: csv
        rows: |
          COUNTRY,TIMEZONE
          FRANCE,Europe/Paris

    expect:
      format: csv
      rows: |
        FORUM_KEY,FORUM_SOURCE,FORUM_COUNTRY
        b4d2197189f192c4e623999bc6167df1,BI,FRANCE