version: 2

sources:
  - name: LAND
    schema: LANDING
    tables:
      
      - name: GAMEDAY_MODIF
        description: The table display source gameday wich to be changed or grouped
        identifier: LANDING_GAMEDAY_MODIFICATION
        columns:

          - name: SEASON_ID
            description: The ID of the season
            tests:
              - is_foreign_key:
                  to_model: ref('curated_season')
                  to_column: SEASON_ID 

          - name: COMPETITION_ID
            description: Identifier of the competition
            tests:
              - is_foreign_key:
                  to_model: ref('curated_competition')
                  to_column: COMPETITION_ID 

          - name: GAMEDAY
            description: The gameday we need to modified
            tests:
              - is_foreign_key:
                  to_model: source('LAND','GAME')
                  to_column: GAMEDAY

          - name: GAMEDAY_MODIFIED
            description: The gameday modified
            tests:
              - not_null