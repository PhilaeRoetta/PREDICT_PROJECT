models:

- name: curated_choice_bonus_check
  tags: ['main']
  description: Gather choices for bonus games made by users on forum
  columns:
  - name: CHOICE_BONUS_KEY
    description: Primary key based on FORUM_SOURCE, MESSAGE_FORUM_ID, EDITION_TIME_UTC and PREDICT_ID. Same key on curated_predictraw_check
    tests:
      - unique
      - not_null

  - name: MESSAGE_EDITION_KEY
    description: Foreign key to match a choice with a message and its edition time
    tests:
      - is_foreign_key:
          to_model: ref('curated_message_check')
          to_column: MESSAGE_EDITION_KEY

  - name: SEASON_KEY
    description: Foreign key to match a choice with a season
    tests:
      - is_foreign_key:
          to_model: ref('curated_season')
          to_column: SEASON_KEY

  - name: USER_KEY
    description: Foreign key to match a choice with a user
    tests:
      - is_foreign_key:
          to_model: ref('curated_user')
          to_column: USER_KEY

  - name: FORUM_KEY
    description: Foreign key to match a choice with a forum
    tests:
      - is_foreign_key:
          to_model: ref('curated_forum')
          to_column: FORUM_KEY

  - name: GAMEDAY_KEY
    description: Foreign key to match a choice with a gameday
    tests:
      - is_foreign_key:
          to_model: ref('curated_gameday')
          to_column: GAMEDAY_KEY

  - name: GAME_KEY
    description: Foreign key to match a choice with a game
    tests:
      - is_foreign_key:
          to_model: ref('curated_game')
          to_column: GAME_KEY

  - name: EDITION_TIME_LOCAL
    description: The time of edition  (or creation if not edited) of the message in the timezone of the forum. 
    tests:
      - not_null

  - name: EDITION_TIME_UTC
    description: The time of edition  (or creation if not edited) of the message in utc time. 
    tests:
      - not_null

  - name: PREDICT_ID
    description: The id of the prediction
    tests:
      - not_null

  - name: PREDICT_RAW
    description: The raw value of the prediction
    tests:
      - not_null

  - name: PREDICT
    description: The value of the prediction
    tests:
      - not_null

  - name: IS_PREDICTION_FROM_MESSAGE
    description: Boolean to know if a choice is from prediction directly (1) or from correction (0)
    tests:
      - accepted_values: 
          values: [0, 1]

  - name: IS_PROGRAM_REFINEMENT
    description: Boolean to know if a choice corrected is because of the program refinement (1) or because of an error from the user (0)
    tests:
      - accepted_values: 
          values: [0, 1]

  - name: IS_LAST_ONTIME
    description: Boolean to know if a choice is the last ontime before the beginning of the game chosen (1) or not (0)
    tests:
      - accepted_values: 
          values: [0, 1]

  - name: UPDATED_AT_UTC
    description: The datetime of update in utc timezone
    tests:
      - not_null

  - name: UPDATED_AT_LOCAL
    description: The datetime of update in local forum country timezone
    tests:
      - not_null