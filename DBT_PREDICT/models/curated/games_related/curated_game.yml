models:

- name: curated_game
  tags: ['init_compet']
  description: Get all game we at least once processed
  columns:
  - name: GAME_KEY
    description: Primary key based on COMPETITION_SOURCE and GAME_SOURCE_ID
    tests:
      - unique
      - not_null

  - name: SEASON_KEY
    description: Foreign key to match a game with a season
    tests:
      - is_foreign_key:
          to_model: ref('curated_season')
          to_column: SEASON_KEY

  - name: COMPETITION_KEY
    description: Foreign key to match a game with a competition
    tests:
      - is_foreign_key:
          to_model: ref('curated_competition')
          to_column: COMPETITION_KEY

  - name: GAMEDAY_KEY
    description: Foreign key to match a game with a gameday
    tests:
      - is_foreign_key:
          to_model: ref('curated_gameday')
          to_column: GAMEDAY_KEY

  - name: TEAM_HOME_KEY
    description: Foreign key to match a game with a home team
    tests:
      - is_foreign_key:
          to_model: ref('curated_team')
          to_column: TEAM_KEY

  - name: TEAM_AWAY_KEY
    description: Foreign key to match a game with an away team
    tests:
      - is_foreign_key:
          to_model: ref('curated_team')
          to_column: TEAM_KEY

  - name: GAME_SOURCE_ID
    description: The id of the game on the source 
    tests:
      - not_null

  - name: GAME_MESSAGE_SHORT
    description: The short version of the game for message posts
    tests:
      - is_integer

  - name: GAME_MESSAGE
    description: The long version of the game for message posts (concatenated with the gameday_message)
    tests:
      - not_null

  - name: DATE_GAME_LOCAL
    description: The local date of the game

  - name: TIME_GAME_LOCAL
    description: The local time of the game

  - name: DATE_GAME_UTC
    description: The utc date of the game

  - name: TIME_GAME_UTC
    description: The utc time of the game

  - name: SCORE_HOME
    description: The score of the home team
    tests:
      - is_integer

  - name: SCORE_AWAY
    description: The score of the away team
    tests:
      - is_integer

  - name: RESULT
    description: The result of the game (difference between score_home and score_away)
    tests:
      - is_integer

  - name: IS_PLAYED
    description: Boolean to know if a game is played (1) or not (0)
    tests:
      - accepted_values: 
          values: [0, 1]

  - name: UPDATED_AT_UTC
    description: The datetime of update in utc timezone
    tests:
      - not_null

  - name: UPDATED_AT_LOCAL
    description: The datetime of update in local season country timezone
    tests:
      - not_null